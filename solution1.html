<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Daily Crossword - Solution</title>
<style>
:root{
  --teal:#1f9dbf;
  --gold:#f5b041;
  --gray:#ddd;
  --bg:#fafafa;
}
body{
  font-family:Arial,Helvetica,sans-serif;
  margin:0;
  padding:0;
  background:var(--bg);
  color:#222;
}
.wrapper{
  max-width:950px;
  margin:auto;
  padding:12px;
  text-align:center;
}
h1{
  color:var(--teal);
  margin:.3em 0 .1em;
  font-size:1.8em;
}
h2{
  color:#555;
  font-size:1.1em;
  margin:0 0 .8em;
  font-weight:normal;
}
p.instructions{
  font-style:italic;
  color:#666;
  margin-top:-4px;
}
#status{
  margin:8px 0;
  color:#a00;
  font-size:.9em;
}
table.solution-grid{
  border-collapse:collapse;
  margin:10px auto;
}
table.solution-grid td{
  width:22px;
  height:22px;
  border:1px solid var(--gray);
  padding:0;
  position:relative;
  text-align:center;
  vertical-align:middle;
  font-weight:bold;
  text-transform:uppercase;
  font-size:14px;
}
td.block{
  background:var(--gold);
}
td .num{
  position:absolute;
  top:1px;
  left:2px;
  font-size:9px;
  color:#444;
}
.clues{
  display:flex;
  flex-wrap:wrap;
  gap:20px;
  justify-content:center;
  text-align:left;
  margin-top:14px;
}
.clues-section{
  flex:1 1 300px;
  max-width:420px;
}
.clues-header{
  background:var(--teal);
  color:#fff;
  padding:6px 10px;
  border-radius:6px;
  font-weight:bold;
  margin:0 0 6px;
  font-size:.95rem;
  text-transform:uppercase;
  letter-spacing:.03em;
}
.clues ul{
  padding-left:20px;
  margin:0;
}
.clues li{
  margin-bottom:5px;
}
@media(max-width:600px){
  table.solution-grid td{
    width:18px;
    height:18px;
    font-size:12px;
  }
}
</style>
</head>
<body>
<div class="wrapper">
  <h1>Daily Crossword - Solution</h1>
  <h2 id="subtitle"></h2>
  <p class="instructions">Here’s the completed crossword from yesterday’s puzzle.</p>
  <div id="status"></div>

  <table id="grid" class="solution-grid"></table>

  <div id="clues" class="clues"></div>
</div>

<script>
const statusEl = document.getElementById('status');
const gridTable = document.getElementById('grid');
const cluesEl = document.getElementById('clues');
const subtitleEl = document.getElementById('subtitle');

fetch('./puzzle.json')
  .then(r => {
    if (!r.ok) throw new Error('HTTP ' + r.status);
    return r.json();
  })
  .then(data => {
    try {
      const grid = data.grid || [];
      const numbers = data.numbers || [];
      const solution = data.solution || null;
      const across = data.across || {};
      const down   = data.down   || {};

      subtitleEl.textContent = data.subtitle || '';

      const rows = grid.length;
      if (!rows) {
        statusEl.textContent = 'No grid data found in puzzle.json.';
        return;
      }
      const cols = grid.reduce((m,row) => Math.max(m, row.length), 0);
      if (!cols) {
        statusEl.textContent = 'No columns found in grid.';
        return;
      }

      // Build table
      for (let r = 0; r < rows; r++) {
        const tr = document.createElement('tr');
        const row = grid[r] || [];
        const numRow = numbers[r] || [];
        for (let c = 0; c < cols; c++) {
          const td = document.createElement('td');
          const v = row[c] !== undefined ? row[c] : '#';
          const isBlock = v === '#';

          if (isBlock) {
            td.classList.add('block');
          } else {
            const numVal = numRow[c] || 0;
            if (numVal) {
              const numDiv = document.createElement('div');
              numDiv.className = 'num';
              numDiv.textContent = numVal;
              td.appendChild(numDiv);
            }

            let letter = '';
            if (solution && solution[r] && solution[r][c] && solution[r][c] !== '#') {
              letter = String(solution[r][c]).toUpperCase();
            }
            td.appendChild(document.createTextNode(letter));
          }

          tr.appendChild(td);
        }
        gridTable.appendChild(tr);
      }

      // Build clues lists
      let html = '';

      html += `<div class="clues-section"><div class="clues-header">Across</div><ul>`;
      for (const [n, txt] of Object.entries(across)) {
        html += `<li><b>${n}.</b> ${txt}</li>`;
      }
      html += `</ul></div>`;

      html += `<div class="clues-section"><div class="clues-header">Down</div><ul>`;
      for (const [n, txt] of Object.entries(down)) {
        html += `<li><b>${n}.</b> ${txt}</li>`;
      }
      html += `</ul></div>`;

      cluesEl.innerHTML = html;

    } catch (e) {
      console.error(e);
      statusEl.textContent = 'Error rendering solution: ' + e.message;
    }
  })
  .catch(err => {
    console.error(err);
    statusEl.textContent = 'Error loading puzzle.json: ' + err.message;
  });
</script>
</body>
</html>
